var notifications = {	status: false,	lastNotification: null,	notification: null,	duration: 5,	activeNotif: 0,	timeoutID: null,	albumArtUrl:'res/icons/Deezer_icon_48x48.png',	init: function(source) {		if(localStorage.getItem('notificationsStatus') == 'false')			notifications.status = false;		else 			notifications.status = true;		notifications.duration = parseInt(localStorage.getItem('notificationsDuration'));		if(notifications.duration < 3)			notifications.duration = 3;					if(source == 'options') {				document.getElementById("activateNotifications").checked = notifications.status;			document.getElementById("notificationsDuration").value = notifications.duration;		}	},	toggleStatus: function() {		localStorage.setItem("notificationsStatus", document.getElementById("activateNotifications").checked);		localStorage.setItem("notificationsDuration", document.getElementById("notificationsDuration").value);	},	pushInformations: function() {      if(notifications.lastNotification != songData.songInf.firstSeen) {			if(notifications.activeNotif > 0) {				notifications.notification.cancel();				notifications.activeNotif=0;				window.clearTimeout(notifications.timeoutID);			}			notifications.lastNotification = songData.songInf.firstSeen;				  if(1) {	// Deezer a changé la structure de son code, on passe par last.fm à tous les coups // songData.songInf.coverURL == ""		  var xhr = new XMLHttpRequest(); 		  xhr.onreadystatechange = function() { 			 if(xhr.readyState == 4) {				if(xhr.status == 200) { 					 notifications.albumArtUrl = xhr.responseXML.getElementsByTagName('image');					 if(notifications.albumArtUrl.length) {						notifications.albumArtUrl = xhr.responseXML.getElementsByTagName('image');						notifications.albumArtUrl = notifications.albumArtUrl[1].textContent;					}					 else						notifications.albumArtUrl = 'res/icons/Deezer_icon_48x48.png';				}			}		 }; 		xhr.open("GET", "http://ws.audioscrobbler.com/2.0/?method=album.getinfo&autocorrect=1&api_key=b25b959554ed76058ac220b7b2e0a026&artist=" + encodeURIComponent(songData.songInf.currentArtist) + "&track=" + encodeURIComponent(songData.songInf.currentSong) + "&album=" + encodeURIComponent(songData.songInf.currentAlbum), false);		xhr.send(); 	 } else {		notifications.albumArtUrl = songData.songInf.coverURL;	 }		notifications.notification = webkitNotifications.createNotification(		notifications.albumArtUrl,  // icon url - can be relative		'Now playing :',  // notification title		songData.songInf.currentSong + ' par '  + songData.songInf.currentArtist + ' sur ' + songData.songInf.currentAlbum// notification body text	);		notifications.notification.show();	notifications.activeNotif = 1;				notifications.timeoutID = window.setTimeout(function() {notifications.notification.cancel();notifications.activeNotif=0;}, notifications.duration * 1000);		 }	},	unload: function() {		status = false;		lastNotification = null;		notification = null;		duration = 1;	}}